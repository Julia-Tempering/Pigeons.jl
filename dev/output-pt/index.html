<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PT diagnostics · Pigeons.jl</title><meta name="title" content="PT diagnostics · Pigeons.jl"/><meta property="og:title" content="PT diagnostics · Pigeons.jl"/><meta property="twitter:title" content="PT diagnostics · Pigeons.jl"/><meta name="description" content="Documentation for Pigeons.jl."/><meta property="og:description" content="Documentation for Pigeons.jl."/><meta property="twitter:description" content="Documentation for Pigeons.jl."/><meta property="og:url" content="https://Julia-Tempering.github.io/Pigeons.jl/output-pt/"/><meta property="twitter:url" content="https://Julia-Tempering.github.io/Pigeons.jl/output-pt/"/><link rel="canonical" href="https://Julia-Tempering.github.io/Pigeons.jl/output-pt/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Pigeons.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Basic usage (local)</a></li><li><a class="tocitem" href="../unidentifiable-example/">Why parallel tempering (PT)?</a></li><li><a class="tocitem" href="../parallel/">Parallelization</a></li><li><a class="tocitem" href="../mpi/">Distributed usage (MPI)</a></li><li><a class="tocitem" href="../variational/">Variational PT</a></li><li><span class="tocitem">Supported inputs</span><ul><li><a class="tocitem" href="../input-overview/">Inputs overview</a></li><li><a class="tocitem" href="../input-turing/">Turing.jl model</a></li><li><a class="tocitem" href="../input-julia/">Black-box function</a></li><li><a class="tocitem" href="../input-stan/">Stan model</a></li><li><a class="tocitem" href="../input-nonjulian/">Non-julian MCMC</a></li><li><a class="tocitem" href="../input-explorers/">Custom MCMC</a></li></ul></li><li><span class="tocitem">Outputs</span><ul><li><a class="tocitem" href="../output-overview/">Outputs overview</a></li><li><a class="tocitem" href="../output-inferencereport/">Automated reports</a></li><li><a class="tocitem" href="../output-reports/">Standard output</a></li><li><a class="tocitem" href="../output-traces/">Traces</a></li><li><a class="tocitem" href="../output-plotting/">Plots</a></li><li><a class="tocitem" href="../output-normalization/">log(Z)</a></li><li><a class="tocitem" href="../output-numerical/">Numerical</a></li><li><a class="tocitem" href="../output-online/">Online stats</a></li><li><a class="tocitem" href="../output-off-memory/">Off-memory</a></li><li class="is-active"><a class="tocitem" href>PT diagnostics</a><ul class="internal"><li><a class="tocitem" href="#Global-communication-barrier"><span>Global communication barrier</span></a></li><li><a class="tocitem" href="#Round-trips-and-tempered-restarts"><span>Round trips and tempered restarts</span></a></li><li><a class="tocitem" href="#Local-communication-barrier"><span>Local communication barrier</span></a></li><li><a class="tocitem" href="#Index-process"><span>Index process</span></a></li></ul></li><li><a class="tocitem" href="../output-custom-types/">Custom types</a></li><li><a class="tocitem" href="../output-extended/">Extended output</a></li><li><a class="tocitem" href="../output-mpi-postprocessing/">MPI output</a></li></ul></li><li><a class="tocitem" href="../checkpoints/">Checkpoints</a></li><li><a class="tocitem" href="../correctness/">Correctness checks</a></li><li><a class="tocitem" href="../pt/">More on PT</a></li><li><a class="tocitem" href="../distributed/">More on distributed PT</a></li><li><a class="tocitem" href="../interfaces/">Interfaces</a></li><li><a class="tocitem" href="../reference/">Reference</a></li><li><a class="tocitem" href="../about-us/">About Us</a></li><li><a class="tocitem" href="../gsoc/">Google Summer of Code</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Outputs</a></li><li class="is-active"><a href>PT diagnostics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PT diagnostics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Julia-Tempering/Pigeons.jl/blob/main/docs/src/output-pt.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="output-pt"><a class="docs-heading-anchor" href="#output-pt">Parallel Tempering-specific diagnostics</a><a id="output-pt-1"></a><a class="docs-heading-anchor-permalink" href="#output-pt" title="Permalink"></a></h1><p>We describe how to produce some key  non-reversible parallel tempering diagnostics  described in <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/rssb.12464">Syed et al., 2021</a>. </p><h2 id="Global-communication-barrier"><a class="docs-heading-anchor" href="#Global-communication-barrier">Global communication barrier</a><a id="Global-communication-barrier-1"></a><a class="docs-heading-anchor-permalink" href="#Global-communication-barrier" title="Permalink"></a></h2><p>The global communication barrier can be used  to set the number of chains.  The theoretical framework of Syed et al., 2021   yields that under simplifying assumptions, it is optimal to set the number of chains  (the argument <code>n_chains</code> in <a href="../reference/#Pigeons.Inputs"><code>Inputs</code></a> or  <code>pigeons()</code>) to roughly 2Λ.</p><p>The global communication barrier is shown  at each round and can also be accessed via  <a href="../reference/#Pigeons.global_barrier-Tuple{Any}"><code>global_barrier()</code></a>.</p><pre><code class="language-julia hljs">using DynamicPPL
using Pigeons

pt = pigeons(target = Pigeons.toy_turing_unid_target(100, 50))
Pigeons.global_barrier(pt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.4911469199502336</code></pre><p>When both a fixed and variational are used, they are printed separately,  labelled Λ and Λ_var for the fixed and variational global barriers  respectively:</p><pre><code class="language-julia hljs">using DynamicPPL
using Pigeons

pt = pigeons(target = Pigeons.toy_turing_unid_target(100, 50),
                variational = GaussianReference(),
                n_chains_variational = 10)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">┌ Info: </span></span>Neither traces, disk, nor online recorders included.
<span class="sgr36"><span class="sgr1">│ </span></span>   You may not have access to your samples (unless you are using a custom recorder, or maybe you just want log(Z)).
<span class="sgr36"><span class="sgr1">└ </span></span>   To add recorders, use e.g. pigeons(target = ..., record = [traces; record_default()])
─────────────────────────────────────────────────────────────────────────────────────────────────────────────
  scans        Λ        Λ_var      time(s)    allc(B)  log(Z₁/Z₀)   min(α)     mean(α)    min(αₑ)   mean(αₑ)
────────── ────────── ────────── ────────── ────────── ────────── ────────── ────────── ────────── ──────────
        2       1.39       3.24      0.291   9.55e+06      -8.14    0.00178      0.756          1          1
        4        2.4       1.55    0.00521   2.94e+06      -5.27     0.0352      0.792          1          1
        8       1.65       1.71    0.00942   5.67e+06       -4.4      0.331      0.823          1          1
       16       1.76       1.86      0.018   1.15e+07      -4.51      0.545       0.81          1          1
       32        1.4       1.64      0.127   2.31e+07      -4.95      0.636       0.84          1          1
       64       1.69       1.54     0.0605   4.51e+07      -4.95      0.538       0.83          1          1
      128        1.5       1.03      0.414   1.18e+08      -5.19      0.687      0.867          1          1
      256       1.54       0.97      0.283   2.12e+08      -4.91      0.786      0.868          1          1
      512       1.51       1.01      0.648   4.22e+08      -5.08      0.795      0.868          1          1
 1.02e+03       1.48       1.02        1.3   8.42e+08      -4.93      0.815      0.868          1          1
─────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre><h2 id="Round-trips-and-tempered-restarts"><a class="docs-heading-anchor" href="#Round-trips-and-tempered-restarts">Round trips and tempered restarts</a><a id="Round-trips-and-tempered-restarts-1"></a><a class="docs-heading-anchor-permalink" href="#Round-trips-and-tempered-restarts" title="Permalink"></a></h2><p>A tempered restart happens when a sample from the reference  percolates to the target.  When the reference supports iid sampling, tempered restarts  can enable large jumps in the state space. </p><p>A round-trip happens when we have a full cycle from  reference to target and back to reference. </p><p>To count tempered restarts and round trips,  add the <a href="../reference/#Pigeons.round_trip-Tuple{}"><code>round_trip()</code></a> recorder:</p><pre><code class="language-julia hljs">pt = pigeons(target = Pigeons.toy_turing_unid_target(100, 50),
           record = [round_trip; record_default()])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">┌ Info: </span></span>Neither traces, disk, nor online recorders included.
<span class="sgr36"><span class="sgr1">│ </span></span>   You may not have access to your samples (unless you are using a custom recorder, or maybe you just want log(Z)).
<span class="sgr36"><span class="sgr1">└ </span></span>   To add recorders, use e.g. pigeons(target = ..., record = [traces; record_default()])
─────────────────────────────────────────────────────────────────────────────────────────────────────────────
  scans     restarts      Λ        time(s)    allc(B)  log(Z₁/Z₀)   min(α)     mean(α)    min(αₑ)   mean(αₑ)
────────── ────────── ────────── ────────── ────────── ────────── ────────── ────────── ────────── ──────────
        2          0       3.24    0.00814   9.75e+05      -8.14    0.00178       0.64          1          1
        4          0       1.64    0.00245   1.37e+06      -5.04     0.0352      0.818          1          1
        8          0       1.17    0.00438   2.67e+06      -4.42      0.708      0.871          1          1
       16          1        1.2    0.00853   5.61e+06      -4.03      0.549      0.867          1          1
       32          6       1.11     0.0166    1.1e+07      -4.77      0.754      0.877          1          1
       64         11       1.35     0.0333   2.19e+07      -4.79      0.698       0.85          1          1
      128         25        1.6      0.066   4.34e+07      -4.97      0.725      0.823          1          1
      256         43       1.51      0.131   8.58e+07      -4.92      0.758      0.832          1          1
      512         92       1.46      0.266   1.73e+08         -5      0.806      0.838          1          1
 1.02e+03        188       1.49      0.617   3.47e+08      -4.92      0.798      0.834          1          1
─────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre><p>The values can also be accessed as follows:</p><pre><code class="language-julia hljs">Pigeons.n_tempered_restarts(pt), Pigeons.n_round_trips(pt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(188, 182)</code></pre><h2 id="Local-communication-barrier"><a class="docs-heading-anchor" href="#Local-communication-barrier">Local communication barrier</a><a id="Local-communication-barrier-1"></a><a class="docs-heading-anchor-permalink" href="#Local-communication-barrier" title="Permalink"></a></h2><p>When the global communication barrier is large,  many chains may be required to obtain tempered restarts. </p><p>The local communication barrier can be used to  visualize the cause of a high global communication barrier.  For example, if there is a sharp peak close to a  reference constructed from the prior, it may be  useful to switch to a <a href="../variational/#variational-pt">variational approximation</a>.</p><p>The local barrier can be plotted as follows:</p><pre><code class="language-julia hljs">using Plots
plotlyjs()
myplot = plot(pt.shared.tempering.communication_barriers.localbarrier);
savefig(myplot, &quot;local_barrier_plot.html&quot;);</code></pre><iframe src="../local_barrier_plot.html" style="height:500px;width:100%;"></iframe><h2 id="Index-process"><a class="docs-heading-anchor" href="#Index-process">Index process</a><a id="Index-process-1"></a><a class="docs-heading-anchor-permalink" href="#Index-process" title="Permalink"></a></h2><p>The index process tracks the permutation of chains as machine exchange  annealing parameters. Each row is a chain and each connected line corresponds to a replica. To enable this we use the <a href="../reference/#Pigeons.index_process-Tuple{}"><code>index_process</code></a> recorder:</p><pre><code class="language-julia hljs">pt = pigeons(
        target = toy_mvn_target(1),
        record = [index_process],
        n_rounds = 5)
myplot = plot(pt.reduced_recorders.index_process)
savefig(myplot, &quot;index_process_plot.html&quot;);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">┌ Info: </span></span>Neither traces, disk, nor online recorders included.
<span class="sgr36"><span class="sgr1">│ </span></span>   You may not have access to your samples (unless you are using a custom recorder, or maybe you just want log(Z)).
<span class="sgr36"><span class="sgr1">└ </span></span>   To add recorders, use e.g. pigeons(target = ..., record = [traces; record_default()])
──────────────────────────────────────────────────────
  scans        Λ      log(Z₁/Z₀)   min(α)     mean(α)
────────── ────────── ────────── ────────── ──────────
        2      0.417      -1.56      0.782      0.954
        4      0.564     -0.653       0.61      0.937
        8      0.597     -0.833      0.869      0.934
       16      0.686      -1.35      0.729      0.924
       32      0.818      -1.19        0.8      0.909
──────────────────────────────────────────────────────</code></pre><iframe src="../index_process_plot.html" style="height:500px;width:100%;"></iframe></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../output-off-memory/">« Off-memory</a><a class="docs-footer-nextpage" href="../output-custom-types/">Custom types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 26 September 2024 00:00">Thursday 26 September 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
